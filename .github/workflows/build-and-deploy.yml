name: Build and deploy

on:
  push:
    branches: [ "master" ]



jobs:
  deploy:
    name: Build and deploy
    runs-on: ubuntu-latest

    env:
      LOCAL: hello-world
      REMOTE: https://github.com/kelvinwieth/hello-world.git
      HOST: ${{ secrets.REMOTE_HOST }}
      USERNAME: ${{ secrets.REMOTE_USER }}
      SSH_KEY: ${{ secrets.SERVER_SSH_KEY }}

    steps:
    - name: Pulling repository
      uses: appleboy/ssh-action@master
      with:
        host: $HOST
        username: $USERNAME
        key: $SSH_KEY
        script: if [ -d $LOCAL/.git ]; then cd $LOCAL; git pull; else rm -rf $LOCAL; git clone https://github.com/kelvinwieth/hello-world.git; fi

    # - name: Building project
    #   uses: appleboy/ssh-action@master
    #   with:
    #     host: ${{ secrets.REMOTE_HOST }}
    #     username: ${{ secrets.REMOTE_USER }}
    #     key: ${{ secrets.SERVER_SSH_KEY }}
    #     script: ./scripts/build.sh
    
    # - name: Running project
    #   uses: appleboy/ssh-action@master
    #   with:
    #     host: ${{ secrets.REMOTE_HOST }}
    #     username: ${{ secrets.REMOTE_USER }}
    #     key: ${{ secrets.SERVER_SSH_KEY }}
    #     script: ./scripts/run.sh
    
    # - name: Removing scripts
    #   uses: appleboy/ssh-action@master
    #   with:
    #     host: ${{ secrets.REMOTE_HOST }}
    #     username: ${{ secrets.REMOTE_USER }}
    #     key: ${{ secrets.SERVER_SSH_KEY }}
    #     script: rm -rf scripts
